<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.8.0.final using JasperReports Library version 6.8.0-2ed8dfabb690ff337a5797129f2cd92902b0c87b  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="EstatisticaProspects_Excel" pageWidth="842" pageHeight="1500" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="19746110-1362-42fd-aa15-532a66ef0360">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="129"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="onsys"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<parameter name="cPar" class="java.lang.String"/>
	<parameter name="cCondicao" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
     representante.`NOME` AS representante_NOME,
     representante.`CODIGO` AS representante_CODIGO,
     representante.`APELIDO` AS representante_APELIDO,
     empresa.`logoimg`  AS empresa_logo,
     r.`DESCRICAO` AS regiao,
     case when prospect.SITUACAO = "Importado" THEN
        1 ELSE 0 END Importado,
     case when prospect.SITUACAO = "Rejeitado" THEN
        1 ELSE 0 END Rejeitado,
     case when prospect.SITUACAO = "Aberto" THEN
        1 ELSE 0 END Aberto,
     case when prospect.SITUACAO = "Liberado" THEN
        1 ELSE 0 END Liberado,
     case when prospect.SITUACAO = "Em avaliação" THEN
        1 ELSE 0 END  Avaliacao

FROM
`prospect` prospect INNER JOIN `representante` representante on representante.`id` = prospect.`REPRESENTANTE_id`
     INNER JOIN `empresa`       empresa       ON prospect.`empresa_id` = empresa.`id`
     LEFT JOIN regiao r ON representante.`REGIAO_id` = r.id
$P!{cCondicao}
ORDER BY r.`DESCRICAO`, representante_APELIDO]]>
	</queryString>
	<field name="representante_NOME" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="representante_NOME"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="representante"/>
	</field>
	<field name="representante_CODIGO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="representante_CODIGO"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="representante"/>
	</field>
	<field name="representante_APELIDO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="representante_APELIDO"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="representante"/>
	</field>
	<field name="empresa_logo" class="java.lang.Object">
		<property name="com.jaspersoft.studio.field.label" value="empresa_logo"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="empresa"/>
	</field>
	<field name="regiao" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="regiao"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="regiao"/>
	</field>
	<field name="Importado" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Importado"/>
	</field>
	<field name="Rejeitado" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Rejeitado"/>
	</field>
	<field name="Aberto" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Aberto"/>
	</field>
	<field name="Liberado" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Liberado"/>
	</field>
	<field name="Avaliacao" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Avaliacao"/>
	</field>
	<variable name="totImportado" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$F{Importado}]]></variableExpression>
	</variable>
	<variable name="totRepres" class="java.lang.Integer">
		<variableExpression><![CDATA[$F{Importado}+$F{Rejeitado}+$F{Aberto}+$F{Liberado}+$F{Avaliacao}]]></variableExpression>
	</variable>
	<variable name="pAprov" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totRejeitado}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="totTotRepres" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$V{totRepres}]]></variableExpression>
	</variable>
	<variable name="totRejeitado" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$F{Rejeitado}]]></variableExpression>
	</variable>
	<variable name="pRejei" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totRejeitado}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="totAberto" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$F{Aberto}]]></variableExpression>
	</variable>
	<variable name="pAberto" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totAberto}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="totLLiberado" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$F{Liberado}]]></variableExpression>
	</variable>
	<variable name="pLiberado" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totLLiberado}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="totAvaliacao" class="java.lang.Integer" resetType="Group" resetGroup="Representante" calculation="Sum">
		<variableExpression><![CDATA[$F{Avaliacao}]]></variableExpression>
	</variable>
	<variable name="pAvaliacao" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totAvaliacao}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="pIMpost" class="java.lang.Double" resetType="Group" resetGroup="Representante">
		<variableExpression><![CDATA[($V{totImportado}.doubleValue()/$V{totTotRepres}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="grTotGeral" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$V{totRepres}]]></variableExpression>
	</variable>
	<variable name="grTotImportado" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$F{Importado}]]></variableExpression>
	</variable>
	<variable name="grPAprov" class="java.lang.Double">
		<variableExpression><![CDATA[($V{grTotImportado}.doubleValue()/$V{grTotGeral}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="grTotRejeitado" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$F{Rejeitado}]]></variableExpression>
	</variable>
	<variable name="grPRegeitado" class="java.lang.Double">
		<variableExpression><![CDATA[($V{grTotRejeitado}.doubleValue()/$V{grTotGeral}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="grTptAberto" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$F{Aberto}]]></variableExpression>
	</variable>
	<variable name="grPAberto" class="java.lang.Double">
		<variableExpression><![CDATA[($V{grTptAberto}.doubleValue()/$V{grTotGeral}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="grTotLiberado" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$F{Liberado}]]></variableExpression>
	</variable>
	<variable name="grPLiberado" class="java.lang.Double">
		<variableExpression><![CDATA[($V{grTotLiberado}.doubleValue()/$V{grTotGeral}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<variable name="grTotAvaliacao" class="java.lang.Integer" resetType="Group" resetGroup="Regiao" calculation="Sum">
		<variableExpression><![CDATA[$F{Avaliacao}]]></variableExpression>
	</variable>
	<variable name="grPAvaliacao" class="java.lang.Double">
		<variableExpression><![CDATA[($V{grTotAvaliacao}.doubleValue()/$V{grTotGeral}.doubleValue())*100.00]]></variableExpression>
	</variable>
	<group name="Regiao">
		<groupExpression><![CDATA[$F{regiao}]]></groupExpression>
		<groupHeader>
			<band>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
			</band>
		</groupHeader>
		<groupFooter>
			<band>
				<property name="com.jaspersoft.studio.unit.height" value="px"/>
			</band>
		</groupFooter>
	</group>
	<group name="Representante">
		<groupExpression><![CDATA[$F{representante_APELIDO}]]></groupExpression>
		<groupHeader>
			<band/>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<textField isBlankWhenNull="true">
					<reportElement x="142" y="0" width="153" height="15" uuid="c477db74-90b4-46b5-8814-8a323e9b20fe"/>
					<textElement verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{representante_APELIDO}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="295" y="0" width="45" height="14" uuid="abe3a37d-8d1f-4c8b-93ac-dfb6b0f31dd2">
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
					</reportElement>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totImportado}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="367" y="0" width="50" height="15" uuid="2509e26e-aa5f-4431-b544-a91395e676a9"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totRejeitado}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="417" y="0" width="32" height="15" uuid="ff7163df-beb1-439b-b1d4-656216fa1a29"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{pRejei}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="449" y="0" width="58" height="15" uuid="d4049d45-e259-442f-b57a-c45dec5610c8"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totAberto}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="507" y="0" width="30" height="15" uuid="26bc231c-4299-4a90-8a4d-350d313efc91"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{pAberto}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="537" y="0" width="61" height="15" uuid="b5026870-e549-4037-b373-563f073f2a05"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totLLiberado}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="598" y="0" width="26" height="15" uuid="db93abbd-f907-4056-8d63-d214544d810b"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{pLiberado}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="624" y="0" width="60" height="15" uuid="8aab1bd0-a34a-48c7-9915-5f8f82a34ede"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totAvaliacao}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="684" y="0" width="33" height="15" uuid="914d9ea1-a60c-43a6-b083-942247a0ecd4"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{pAvaliacao}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="717" y="0" width="67" height="15" uuid="b6814f2d-0a81-4c0c-8e19-fdf82a6702ec"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{totTotRepres}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement x="340" y="0" width="27" height="15" uuid="ffe53c49-69f8-493c-bdc7-74fd01f85682"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{pIMpost}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement x="0" y="0" width="142" height="15" uuid="7f64f3f3-9a16-40b0-b0ae-9c77c7b362cb">
						<property name="com.jaspersoft.studio.unit.height" value="px"/>
					</reportElement>
					<textElement verticalAlignment="Middle">
						<font size="7"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{regiao}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="555" height="20" uuid="bd4dd779-9e1f-44d7-9b49-afd901e36e55"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="SansSerif" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Estatística de prospects]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="22" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="142" y="0" width="153" height="20" backcolor="#CCCCCC" uuid="85cfe05a-5496-4da6-856d-bd720de8a441"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Representante]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="295" y="0" width="45" height="20" backcolor="#CCCCCC" uuid="42b56bc4-025e-4310-ad2d-e25e17b0c4b6"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Aprovado]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="367" y="0" width="50" height="20" backcolor="#CCCCCC" uuid="d9ab6c91-a831-44c5-8abc-e6f829c80571"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Rejeitado]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="449" y="0" width="58" height="20" backcolor="#CCCCCC" uuid="733e5acd-0504-476d-8e9d-8ac04eb88163"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Aberto]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="537" y="0" width="61" height="20" backcolor="#CCCCCC" uuid="1ca86f6d-093c-47af-b8fb-dcfbcf37429a"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Liberado]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="624" y="0" width="60" height="20" backcolor="#CCCCCC" uuid="3e6df25e-0380-4e38-be76-690eb286d7b7"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Em avaliação]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="717" y="0" width="67" height="20" backcolor="#CCCCCC" uuid="58f1311d-8091-446a-a3cb-f0461ca5531d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Total]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="20" width="784" height="1" uuid="c265de16-1331-4367-8c9b-6053dab24ead"/>
			</line>
			<staticText>
				<reportElement mode="Opaque" x="340" y="0" width="27" height="20" backcolor="#CCCCCC" uuid="2ec39f37-85a3-4590-954b-b67f52002875"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="417" y="0" width="32" height="20" backcolor="#CCCCCC" uuid="5d08f8ce-badb-40b2-8294-b953d5113fd5"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="507" y="0" width="30" height="20" backcolor="#CCCCCC" uuid="603d2a27-021b-44d1-8a6b-fd2e0dfb4d2d"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="598" y="0" width="26" height="20" backcolor="#CCCCCC" uuid="ebe93200-7509-426e-91b6-2a5cc4b3f837"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="684" y="0" width="33" height="20" backcolor="#CCCCCC" uuid="8c3bca2d-e8b7-4f18-8f7a-c7d5038df481"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="142" height="20" backcolor="#CCCCCC" uuid="14671289-8c6f-4450-b6c2-6411445bc336">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Região]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="153" height="0" uuid="5a77d67c-b311-48c3-8b46-564141702fca"/>
				<textElement verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{representante_APELIDO}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
</jasperReport>
