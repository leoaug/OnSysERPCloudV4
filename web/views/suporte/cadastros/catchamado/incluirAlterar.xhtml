<html   xmlns:c="http://java.sun.com/jsp/jstl/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://primefaces.org/ui"                   
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"> 
    
    <p:dialog widgetVar="dialogo" id="dialogo" positionType="absolute"   
              position="top" style="max-width: 800px!important" 
              responsive="true" width="95%" height="95%"
              modal="true" header="#{catChamadoFace.tituloDialogo}"
              resizable="true">    
        
        <f:view contentType="text/html; charset=utf-8"> 
            <h:form id="fm">   
                 <c:if test="#{catChamadoFace.operacao eq 'I'}">                  
                    <p:focus for="codigo"/>
                </c:if>
                <c:if test="#{catChamadoFace.operacao eq 'A'}">                  
                    <p:focus for="descricao"/>
                </c:if>     
                <script type="text/javascript" src="../../../../resources/js/jquery.price_format.js"></script> 
                <script type="text/javascript" src="../../../../resources/js/locale-primefaces.js" ></script>
                    <p:toolbar style="height: 35px">
                        <f:facet name="left">
                            <p:commandButton title="Salvar dados do registro corrente e voltar para lista de categorias de chamado." 
                                             action="#{catChamadoFace.fimIncluirAlterar(usuarioFace.loggedUser.empresa.codigo, false)}" 
                                             style="height: 30px; width: 100px;"
                                             styleClass="GreenButton"
                                             icon="fa fa-check white"
                                             value="Salvar"
                                             update=":fmListar:Dtb, fm"
                                             alt="Salvar dados do registro corrente e voltar para lista de categorias de chamado."
                                             process="@form"
                                             onclick="PF('PrimeFaces.monitorDownload(startMessage, finishMessage)')"/>                                
                            <p:spacer width="5" height="5"/>
                            <c:if test="#{catChamadoFace.operacao == 'I'}">
                                <p:commandButton title="Salvar dados do registro corrente e criar uma nova cetegoria de chamado." 
                                                 action="#{catChamadoFace.fimIncluirAlterar(usuarioFace.loggedUser.empresa.codigo, true)}" 
                                                 style="height: 30px; width: 125px; font-size: 10px"
                                                 styleClass="GreenButton"
                                                 update=":fmListar:Dtb, fm, messages"
                                                 value="Salvar e novo"
                                                 process="@form"
                                                 onclick="PF('PrimeFaces.monitorDownload(startMessage, finishMessage)')"/>                                
                                <p:spacer width="5" height="5"/>
                            </c:if>
                            <p:commandButton immediate="true"
                                             style="height: 30px; width: 100px;"
                                             icon="fa fa-reply Fs12 white"
                                             value="Voltar" styleClass="RedButton"
                                             oncomplete="if (!args.validationFailed) PF('dialogo').hide()"
                                             title="Voltar para lista de categorias de chamado." 
                                             onclick="PF('PrimeFaces.monitorDownload(startMessage, finishMessage)')"
                                             alt="Voltar para lista de categorias de chamado."/>
                            <p:spacer width="5" height="5"/>     
                            <c:if test="#{catChamadoFace.operacao == 'A'}">
                                <c:if test="#{catChamadoFace.getInativo() == 'N'}">
                                    <p:commandButton immediate="true" title="Inativar categoria."
                                                     style="height: 30px; width: 100px;"
                                                     process="@form"
                                                     value="Inativar"
                                                     action="#{catClienteFace.inativar()}" alt="Inativar" icon="fa fa-lock white"/>
                                </c:if>
                                <c:if test="#{catChamadoFace.getInativo() == 'S'}">
                                    <p:commandButton immediate="true" title="Ativar" 
                                                     action="#{catChamadoFace.ativar()}" alt="Ativar categoria." 
                                                     style="height: 30px; width: 100px;"
                                                     process="@form"
                                                     value="Ativar"
                                                     icon="fa fa-unlock white"/>
                                </c:if>
                                <c:if test="#{catChamadoFace.getInativo() == 'S'}">
                                    <h:outputText value="Registro inativado em - " style=" color: red; font-size: 12px"/>
                                    <h:outputText value="#{catChamadoFace.registroSelecionado.datainativo}" 
                                                  style=" color: red; font-size: 12px">
                                        <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
                                    </h:outputText>
                                </c:if>                                        
                            </c:if>                            
                            <p:growl id="messages" showDetail="true" sticky="true" autoUpdate="true"/>
                        </f:facet>
                    </p:toolbar>
                    <div class="ui-fluid">
                        <p:panelGrid layout="grid" columns="3" 
                                     columnClasses="ui-grid-col-3, ui-grid-col-8, ui-grid-col-1"                                          
                                     id="pnlGr" styleClass="semBorda" 
                                     rendered="#{catChamadoFace.registroSelecionado != null}"
                                     style="border: none !important; background-color: #dddddd; overflow: auto; max-height: 480px!important;">
                            
                            <c:if test="#{catChamadoFace.operacao eq 'I'}">
                                <p:outputLabel value="Código" for="codigo" style="color: red"/>
                                <p:inputText  id="codigo" value="#{catChamadoFace.registroSelecionado.codigo}"/>
                            </c:if>
                            <c:if test="#{catChamadoFace.operacao eq 'A'}">
                                <p:outputLabel value="Código" for="codigo" style="color: black"/>
                                <p:inputText  id="codigo" disabled="true" style="color: red"
                                              value="#{catChamadoFace.registroSelecionado.codigo}"/>
                            </c:if>                              
                            <p:spacer width="5"/>                                

                            <p:outputLabel value="Descrição" for="descricao" style="color: red"/>
                            <p:inputText id="descricao" value="#{catChamadoFace.registroSelecionado.descricao}"/>
                            <p:spacer width="5"/>    

                            <p:outputLabel value="Gestor" for="gestor" style="color: black"/>
                            <p:selectOneMenu id="gestor" value="#{catChamadoFace.registroSelecionado.gestor}" var="p">
                                <f:selectItems var="itemSel" itemLabel="#{itemSel.apelido}" itemValue="#{itemSel}" 
                                               value="#{usuarioModuloFace.allUsuarios}"/>
                                 <p:column>#{p.apelido} - #{p.email}</p:column> 
                                <f:converter converterId="usuarioConverter"/>
                            </p:selectOneMenu>                               
                            <p:spacer width="5"/>                              

                            <p:outputLabel for="obs" value="Observação" style="color: black"/>
                            <p:inputTextarea id="obs"  cols="40" rows="5" 
                                             value="#{catChamadoFace.registroSelecionado.obs}"/>
                            <p:spacer width="5"/>                                

                        </p:panelGrid>
                    </div>
                <h:outputText value="Campo(s) obrigatório(s)." style="color: red; font-weight: 700"/>
                <script type="text/javascript">
                    jQuery('.monetario').priceFormat({
                           prefix : 'R$ '
                        });
                    jQuery('.decimal').priceFormat({
                           prefix : '  '
                        });
                </script>
            </h:form>
        </f:view>
    </p:dialog>                        
</html>