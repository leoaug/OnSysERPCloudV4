<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.12.2.final using JasperReports Library version 6.12.2-75c5e90a222ab406e416cbf590a5397028a52de3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ComissRepresSintetico_PDF" pageWidth="595" pageHeight="842" whenNoDataType="NoPages" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="9273339c-7ed6-434e-872e-e66912fa4d2b">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="142"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="853"/>
	<style name="zebra" forecolor="#FFFFFF">
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($V{REPORT_COUNT}.intValue() % 2 == 0)]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF" backcolor="#CCFFFF"/>
		</conditionalStyle>
	</style>
	<parameter name="cPar" class="java.lang.String"/>
	<parameter name="cCondicao" class="java.lang.String"/>
	<parameter name="cEmpresa" class="java.lang.String"/>
	<parameter name="pDataIni" class="java.lang.String"/>
	<parameter name="pDataFim" class="java.lang.String"/>
	<parameter name="cCondicao4" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
     representante.`CODIGO` AS representante_CODIGO,
     representante.`NOME` AS representante_NOME,
     empresa.`logoimg` AS empresa_logo,
     SUM(doctosai.`VLTOTDOCTOLIQ`) AS pedidovendas_VLTOTLIQPEDIDO,
     SUM(0) AS IR,
     SUM(doctosai.`VLTOTDOCTOLIQ` * (pedidovendas.`PERCCOMISSAO` / 100)) AS pedidovendas_VLCOMISSAO,
     SUM(CASE WHEN ((SELECT SUM(1)
		FROM `participante` participanteX INNER JOIN `pedidovendas` pedidovendasX ON participanteX.`id` = pedidovendasX.`CLIENTE_id`
			INNER JOIN `representante`    representanteX   ON representanteX.`id` = participanteX.`REPRESENTANTE_id`
                        INNER JOIN `metapremiorepres` metapremiorepres ON metapremiorepres.`representante_id` = representanteX.`id` and
                                   metapremiorepres.ano = year($P{pDataIni}) and metapremiorepres.mes = month($P{pDataIni})
		WHERE (pedidovendasX.`EMPRESA_id` = $P{cEmpresa}) AND (pedidovendasX.`DATAEMISSAO` >= $P{pDataIni} AND pedidovendasX.`DATAEMISSAO` <= $P{pDataFim}) AND
			(representanteX.`id` = representante.`id` and pedidovendasX.VLTOTPEDIDO > 0
  AND pedidovendasX.SITUACAO <> 'Cancelado'
  AND pedidovendasX.SITUACAO <> 'Pendente'
  AND pedidovendasX.SITUACAO <> 'Bloqueado'
  and pedidovendasX.SITUACAO <> 'Obs')) >= metapremiorepres.`METAPEDIDO`) and metapremiorepres.`METAPEDIDO` <> 0 THEN (doctosai.`VLTOTDOCTOLIQ` * (pedidovendas.`PERCCOMISSAO` / 100)) * (0)
     ELSE
	0 END) AS PremQtdPed,
SUM(CASE WHEN ((SELECT SUM(pedidovendasX.`VLTOTPEDIDO`)
		FROM `participante` participanteX INNER JOIN `pedidovendas` pedidovendasX ON participanteX.`id` = pedidovendasX.`CLIENTE_id`
			INNER JOIN `representante` representanteX ON representanteX.`id` = pedidovendasX.`REPRESENTANTE_id`
                        INNER JOIN `metapremiorepres` metapremiorepres ON metapremiorepres.`representante_id` = representanteX.`id` and
                                   metapremiorepres.ano = year($P{pDataIni}) and metapremiorepres.mes = month($P{pDataIni})
		WHERE (pedidovendasX.`EMPRESA_id` = $P{cEmpresa}) AND (pedidovendasX.`DATAEMISSAO` >= $P{pDataIni} AND pedidovendasX.`DATAEMISSAO` <= $P{pDataFim}) AND
			(representanteX.`id` = representante.`id` and pedidovendasX.VLTOTPEDIDO > 0
  AND pedidovendasX.SITUACAO <> 'Cancelado'
  AND pedidovendasX.SITUACAO <> 'Bloqueado'
  AND pedidovendasX.SITUACAO <> 'Pendente'
  and pedidovendasX.SITUACAO <> 'Obs')) >= metapremiorepres.`METAVALOR`) and metapremiorepres.`METAVALOR` <> 0  THEN (doctosai.`VLTOTDOCTOLIQ` * (pedidovendas.`PERCCOMISSAO` / 100)) * (0)
     ELSE
	0 END)      AS PremValorPed,
  SUM(CASE WHEN ((SELECT MIN(pedidovendasCN.`NRPEDCLI`)
FROM `participante` as  participanteCN, `pedidovendas` as  pedidovendasCN
                     where   participanteCN.`id`     = pedidovendasCN.`CLIENTE_id`
                       and   participanteCN.`id` = participante.id
		       and   pedidovendasCN.`EMPRESA_id` = $P{cEmpresa} AND pedidovendasCN.`DATAEMISSAO` <= $P{pDataFim}
                       AND  (pedidovendasCN.VLTOTPEDIDO > 0
  AND pedidovendasCN.SITUACAO <> 'Cancelado'
  AND pedidovendasCN.SITUACAO <> 'Pendente'
  AND pedidovendasCN.SITUACAO <> 'Bloqueado'
  and pedidovendasCN.SITUACAO <> 'Obs') AND (participanteCN.`DATACADASTRO` >= '2017-03-01')) = doctosai.`NRPEDCLI`) THEN doctosai.`VLTOTDOCTOLIQ` * (pedidovendas.`PERCCOMISSAO` / 100)
  ELSE 0 END) AS PremNovoCli,
CASE WHEN (SELECT SUM(c.vlmovto) FROM comissaomovto c $P!{cCondicao4}) is null THEN 0
  ELSE (SELECT SUM(c.vlmovto) FROM comissaomovto c $P!{cCondicao4}) END AS desconto
FROM `doctosai` doctosai INNER JOIN `representante` representante ON doctosai.`representante_id` = representante.`id`
     INNER JOIN `serienotafiscal` serienotafiscal ON serienotafiscal.`id` = doctosai.`SERIE_id`
     INNER JOIN `participante` participante ON doctosai.`participante_id` = participante.`id`
     INNER JOIN `doctosairep` doctosairep ON doctosai.`id` = doctosairep.`doctosai_id`
     LEFT JOIN `metapremiorepres` metapremiorepres ON metapremiorepres.`representante_id` = representante.`id` and
                                   metapremiorepres.ano = year($P{pDataIni}) and metapremiorepres.mes = month($P{pDataIni})
     INNER JOIN `empresa` empresa ON empresa.`id` = doctosai.`EMPRESA_id`
INNER JOIN `pedidovendas` pedidovendas ON doctosai.`NRPEDCLI` = pedidovendas.`NRPEDCLI` and
                                     pedidovendas.`CLIENTE_id` = doctosai.`participante_id`

$P!{cCondicao}

GROUP BY representante.`CODIGO`, representante.`NOME`, empresa.`logoimg`
ORDER BY
     representante_NOME]]>
	</queryString>
	<field name="representante_CODIGO" class="java.lang.String"/>
	<field name="representante_NOME" class="java.lang.String"/>
	<field name="empresa_logo" class="java.io.InputStream"/>
	<field name="pedidovendas_VLTOTLIQPEDIDO" class="java.math.BigDecimal"/>
	<field name="IR" class="java.math.BigDecimal"/>
	<field name="pedidovendas_VLCOMISSAO" class="java.math.BigDecimal"/>
	<field name="PremQtdPed" class="java.math.BigDecimal"/>
	<field name="PremValorPed" class="java.math.BigDecimal"/>
	<field name="PremNovoCli" class="java.math.BigDecimal"/>
	<field name="desconto" class="java.math.BigDecimal"/>
	<variable name="vTotGerValor" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{pedidovendas_VLTOTLIQPEDIDO}]]></variableExpression>
	</variable>
	<variable name="vTotGerComissao" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{pedidovendas_VLCOMISSAO}]]></variableExpression>
	</variable>
	<variable name="totGerIR" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{IR}]]></variableExpression>
	</variable>
	<variable name="vTotRepCFim" class="java.math.BigDecimal">
		<variableExpression><![CDATA[($F{pedidovendas_VLCOMISSAO}.add($F{PremQtdPed}).add($F{PremValorPed})).subtract($F{desconto})]]></variableExpression>
	</variable>
	<variable name="vTotPQTD" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PremQtdPed}]]></variableExpression>
	</variable>
	<variable name="vTotValor" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PremValorPed}]]></variableExpression>
	</variable>
	<variable name="vTotNovoCli" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PremNovoCli}]]></variableExpression>
	</variable>
	<variable name="vTotComissao" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$V{vTotRepCFim}]]></variableExpression>
	</variable>
	<variable name="vTotDesconto" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{desconto}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="53" splitType="Stretch">
			<textField>
				<reportElement x="106" y="32" width="448" height="20" uuid="1080c0b2-5a97-4d19-9cb1-2c30ef828818"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$P{cPar}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="106" y="0" width="448" height="32" uuid="1ef5ac1b-cc60-4cf0-bea0-f4feeb1bbafe"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Extrato de comissão - sintético]]></text>
			</staticText>
			<image>
				<reportElement x="0" y="0" width="106" height="52" uuid="3ff11d76-b1ba-47d9-b8a1-0b9b922df233"/>
				<imageExpression><![CDATA[$F{empresa_logo}]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="21" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="308" y="0" width="80" height="20" backcolor="#CCCCCC" uuid="f5a72ca3-5b4a-478b-9f27-fd8f732b6b36"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Valor NF]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="388" y="0" width="56" height="20" backcolor="#CCCCCC" uuid="6119c2ad-215c-48cc-b7e2-91111ba223b5"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Val. Comissão]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="40" height="20" backcolor="#CCCCCC" uuid="66b2b955-1233-4d43-aaea-90249712d58d"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Código]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="40" y="0" width="268" height="20" backcolor="#CCCCCC" uuid="c416a3d0-171e-402f-ab0f-f620627366c0"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Representante]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="20" width="555" height="1" uuid="caf2cd93-0736-4462-aa9e-f88906e5e982"/>
				<graphicElement>
					<pen lineWidth="1.5"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement mode="Opaque" x="494" y="0" width="60" height="20" backcolor="#CCCCCC" uuid="a7b04ca0-497f-4b90-9ec4-8121e40e9180"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Tot. Comissão]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="444" y="0" width="50" height="20" backcolor="#CCCCCC" uuid="88a41071-d5c5-4263-b784-30f538c60235"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Outros]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="309" y="0" width="80" height="15" forecolor="#000000" uuid="39bf5886-2371-4655-b5f7-5345b2c552cb"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pedidovendas_VLTOTLIQPEDIDO}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="389" y="0" width="55" height="15" forecolor="#000000" uuid="bb564bae-469a-42c3-be5a-412e6f79967d"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{pedidovendas_VLCOMISSAO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="0" y="0" width="40" height="15" forecolor="#000000" uuid="8f97ac45-e48a-4ebe-bb7b-4704bec1a225"/>
				<textElement verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{representante_CODIGO}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="40" y="0" width="268" height="15" forecolor="#000000" uuid="529eb60c-2b2a-47b0-a0f2-222e9ea989f3"/>
				<textElement verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{representante_NOME}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="494" y="0" width="60" height="15" forecolor="#000000" uuid="92820ee7-7a11-4e3f-82b5-45853823975a"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{vTotRepCFim}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement style="zebra" mode="Opaque" x="444" y="0" width="50" height="15" forecolor="#000000" uuid="92d59540-fb42-4724-bf30-786f9b171704"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{desconto}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="23" splitType="Stretch">
			<line>
				<reportElement x="0" y="1" width="555" height="1" uuid="0792c062-7eee-4ccb-b861-7d68e2f53374"/>
			</line>
			<textField pattern="dd/MM/yyyy HH.mm.ss">
				<reportElement x="0" y="3" width="100" height="20" uuid="14d8c68a-8459-498a-9ee5-d3a5130bca09"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="435" y="3" width="80" height="20" uuid="5c9f248f-e0fe-497f-9c9e-20a1bef923af"/>
				<textElement textAlignment="Right">
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA["Página "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="515" y="3" width="40" height="20" uuid="b1cda1a3-9bed-49eb-8563-39c5ccfca1f4"/>
				<textElement>
					<font size="7"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="148" y="3" width="259" height="16" forecolor="#0000FF" uuid="a8f0e788-fa50-443b-af23-ee0254da1e03"/>
				<textElement textAlignment="Center">
					<font size="7"/>
				</textElement>
				<text><![CDATA[OnSys ERP Cloud - www.onsys.com.br]]></text>
			</staticText>
		</band>
	</pageFooter>
	<summary>
		<band height="24" splitType="Stretch">
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="310" y="4" width="80" height="20" uuid="0a7e5a5a-ae69-4570-96f3-036d4d821237"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{vTotGerValor}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="210" y="1" width="345" height="1" uuid="dfe1578a-fb0c-47d3-8312-4e5a507a360b"/>
			</line>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="390" y="4" width="55" height="20" uuid="15fa0806-937e-4371-b1d5-74ad77470d78"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{vTotGerComissao}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="248" y="2" width="62" height="20" uuid="e47f9bb1-d836-4060-a164-80f9a215f63c"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<text><![CDATA[Total geral ==>]]></text>
			</staticText>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="495" y="4" width="60" height="20" uuid="583d0e44-16d8-4d70-8ecf-fef0ebc5f52a"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{vTotComissao}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement x="445" y="4" width="50" height="20" uuid="48a54e6d-969f-46ef-80ef-de7fc5ee0ac2"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="7" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{vTotDesconto}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
